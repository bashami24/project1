CASE
    WHEN REOPEN_TIMESTAMP BETWEEN {{snapshot_begin_date}} AND {{snapshot_end_date}}
         AND (
               (
                 LAG(STATUS_NAME) OVER (PARTITION BY CLAIM_NUMBER, EXPOSURE_PUBLICID_NK, CLAIM_SYMBOL_CODE ORDER BY REOPEN_TIMESTAMP) = 'Closed'
                 AND STATUS_NAME = 'Reopen'
               )
               OR
               (
                 LAG(STATUS_NAME, 2) OVER (PARTITION BY CLAIM_NUMBER, EXPOSURE_PUBLICID_NK, CLAIM_SYMBOL_CODE ORDER BY REOPEN_TIMESTAMP) = 'Closed'
                 AND LAG(STATUS_NAME) OVER (PARTITION BY CLAIM_NUMBER, EXPOSURE_PUBLICID_NK, CLAIM_SYMBOL_CODE ORDER BY REOPEN_TIMESTAMP) = 'Reopen'
                 AND STATUS_NAME = 'Closed'
               )
             )
    THEN 1
    ELSE 0
END AS NEW_REOPENED_REPORTED_COUNT_1
